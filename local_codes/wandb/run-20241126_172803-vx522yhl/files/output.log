Some weights of EsmModel were not initialized from the model checkpoint at facebook/esm1b_t33_650M_UR50S and are newly initialized: ['esm.pooler.dense.bias', 'esm.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Trainable parameters: 0.657924 M
Total parameters: 653.014425 M
ESM1b(
  (esm): EsmModel(
    (embeddings): EsmEmbeddings(
      (word_embeddings): Embedding(33, 1280, padding_idx=1)
      (layer_norm): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.0, inplace=False)
      (position_embeddings): Embedding(1026, 1280, padding_idx=1)
    )
    (encoder): EsmEncoder(
      (layer): ModuleList(
        (0-32): 33 x EsmLayer(
          (attention): EsmAttention(
            (self): EsmSelfAttention(
              (query): Linear(in_features=1280, out_features=1280, bias=True)
              (key): Linear(in_features=1280, out_features=1280, bias=True)
              (value): Linear(in_features=1280, out_features=1280, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
            (output): EsmSelfOutput(
              (dense): Linear(in_features=1280, out_features=1280, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
            (LayerNorm): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
          )
          (intermediate): EsmIntermediate(
            (dense): Linear(in_features=1280, out_features=5120, bias=True)
          )
          (output): EsmOutput(
            (dense): Linear(in_features=5120, out_features=1280, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (LayerNorm): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
        )
      )
      (emb_layer_norm_after): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
    )
    (pooler): EsmPooler(
      (dense): Linear(in_features=1280, out_features=1280, bias=True)
      (activation): Tanh()
    )
    (contact_head): EsmContactPredictionHead(
      (regression): Linear(in_features=660, out_features=1, bias=True)
      (activation): Sigmoid()
    )
  )
  (layer1): Linear(in_features=1280, out_features=512, bias=True)
  (relu): ReLU()
  (layer2): Linear(in_features=512, out_features=4, bias=True)
)
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
tensor([[-110.1946,   -1.8268,  -14.4450, -115.4546]], device='cuda:0',
       grad_fn=<AddmmBackward0>)
1
other entries
0it [00:00, ?it/s]
tensor([[-38.6369,   1.4687,  -2.0344,  -4.8455]], device='cuda:0')
tensor([3], device='cuda:0')
0it [00:00, ?it/s]
tensor([-26.6341,   2.9272,  -4.6441, -31.5301], device='cuda:0')
tensor([3], device='cuda:0')
0it [00:00, ?it/s]
tensor([ -67.0493,    0.6316,  -14.0777, -111.7730], device='cuda:0')
tensor([3], device='cuda:0')
0it [00:00, ?it/s]
MNPNQKIITIGSVSLTIATVCFLMQIAILATTVTLHFKQNECSIPPNNQVMPCEPIIIEKNITEIVYLNNTTIEKEICPKVPEYRNWSKPQCQITGFAPLSKDNSIRLSAGGDIWVTREPYVSCSPGKCYQFALGQGTTLNNKHSNGTIHDRIPHRTLLMNELGVPFHLGTKQVCIAWSSSSCHDGKAWLHVCVTGDDRNATASFIYDGMLVDSIGSWSQNILRTQESECVCINGTCTVVMTDGSASGRADTRILFIKEGKIIHISPLSGSAQHIEECSCYPRYPDVRCVCRDNWKGSNRPVIDINMADYSIDSSYVCSGLVGDTPRNDDSSSSSNCRDPNNERGNPGVKGWAFDNGNDVWMGRTISKDSRSGYETFRVTGGWTTANSKSQVNRQVIVDNNNWSGYSGIFSVEGKSCINRCFYVELIRGRPQETRVWWTSNSIVVFCGTSGTYGTGSWPDGANINFMPI
3
tensor([-21.4492,   6.1439,  -6.5779, -22.1220], device='cuda:0')
tensor([3], device='cuda:0')
['Viruses', 'cellular organisms', 'unclassified entries', 'other entries']
cuda:0
../checkpoints/Freeze ESM_checkpoints
