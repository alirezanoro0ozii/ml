model: 2.011908 M parameters
EnhancedProteinCNN(
  (embedding): Embedding(25, 128, padding_idx=0)
  (feature_dense): Linear(in_features=3, out_features=128, bias=True)
  (global_feature_dense): Linear(in_features=26, out_features=128, bias=True)
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(3,), stride=(1,), padding=same)
    (1): Conv1d(128, 256, kernel_size=(5,), stride=(1,), padding=same)
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=same)
    (3): Conv1d(128, 256, kernel_size=(9,), stride=(1,), padding=same)
    (4): Conv1d(128, 256, kernel_size=(11,), stride=(1,), padding=same)
  )
  (batch_norms): ModuleList(
    (0-4): 5 x BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc1): Linear(in_features=1408, out_features=512, bias=True)
  (fc2): Linear(in_features=512, out_features=256, bias=True)
  (fc3): Linear(in_features=256, out_features=4, bias=True)
  (dropout): Dropout(p=0.5, inplace=False)
  (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
)
  0%|          | 0/100000 [00:02<?, ?it/s]
  0%|          | 0/100000 [00:00<?, ?it/s]
torch.Size([64, 1000, 4])
tensor([[[ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         [ 5.0000e+00, -3.5000e+00,  1.3840e+02,  4.9900e+01],
         [ 1.3000e+01, -3.5000e+00,  1.1410e+02,  3.3800e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],

        [[ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         [ 9.0000e+00,  4.5000e+00,  1.6670e+02,  1.3000e-01],
         [ 1.4000e+01, -1.6000e+00,  1.1270e+02,  1.5800e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],

        [[ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         [ 1.4000e+01, -1.6000e+00,  1.1270e+02,  1.5800e+00],
         [ 1.1000e+01,  3.8000e+00,  1.6670e+02,  1.3000e-01],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],

        ...,

        [[ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         [ 4.0000e+00, -3.5000e+00,  1.1110e+02,  4.9700e+01],
         [ 1.0000e+01, -3.9000e+00,  1.6860e+02,  4.9500e+01],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],

        [[ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         [ 5.0000e+00, -3.5000e+00,  1.3840e+02,  4.9900e+01],
         [ 1.3000e+01, -3.5000e+00,  1.1410e+02,  3.3800e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],

        [[ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         [ 9.0000e+00,  4.5000e+00,  1.6670e+02,  1.3000e-01],
         [ 1.2000e+01,  1.9000e+00,  1.6290e+02,  1.4300e+00],
         ...,
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
         [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]]],
       device='cuda:1')
torch.Size([64, 28])
tensor([[4.4922e+04, 1.0380e-01, 4.2468e+01,  ..., 4.3038e-02, 0.0000e+00,
         6.0759e-02],
        [5.3366e+04, 1.0022e-01, 4.8602e+01,  ..., 6.1002e-02, 6.5359e-03,
         3.9216e-02],
        [2.9766e+04, 6.8027e-02, 2.1344e+01,  ..., 1.0884e-01, 1.0204e-02,
         2.7211e-02],
        ...,
        [2.1064e+04, 6.3725e-02, 2.0805e+01,  ..., 6.8627e-02, 0.0000e+00,
         3.4314e-02],
        [2.5331e+04, 1.5044e-01, 6.0391e+01,  ..., 3.9823e-02, 5.7522e-02,
         2.6549e-02],
        [2.6446e+04, 9.5833e-02, 3.8992e+01,  ..., 3.7500e-02, 1.2500e-02,
         4.1667e-02]], device='cuda:1')
model: 2.012164 M parameters
EnhancedProteinCNN(
  (embedding): Embedding(25, 128, padding_idx=0)
  (feature_dense): Linear(in_features=3, out_features=128, bias=True)
  (global_feature_dense): Linear(in_features=28, out_features=128, bias=True)
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(3,), stride=(1,), padding=same)
    (1): Conv1d(128, 256, kernel_size=(5,), stride=(1,), padding=same)
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=same)
    (3): Conv1d(128, 256, kernel_size=(9,), stride=(1,), padding=same)
    (4): Conv1d(128, 256, kernel_size=(11,), stride=(1,), padding=same)
  )
  (batch_norms): ModuleList(
    (0-4): 5 x BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc1): Linear(in_features=1408, out_features=512, bias=True)
  (fc2): Linear(in_features=512, out_features=256, bias=True)
  (fc3): Linear(in_features=256, out_features=4, bias=True)
  (dropout): Dropout(p=0.5, inplace=False)
  (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
)
  0%|          | 15/100000 [00:15<4:42:18,  5.90it/s] 
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
torch.Size([64, 1000, 4])
torch.Size([64, 28])
  6%|â–Œ         | 5767/100000 [16:35<4:31:03,  5.79it/s]  
Epoch [5000/100000]
Train Loss: 0.9918, Train Accuracy: 0.4995
Train F1 (micro): 0.4995, Train F1 (macro): 0.2429
Train Confusion Matrix:
[[     0      0      0      0]
 [    97 107152  52625    126]
 [    79 105790  52687    151]
 [     1    859    433      0]]
Val Loss: 0.8150, Val Accuracy: 0.0147
Val F1 (micro): 0.0147, Val F1 (macro): 0.0097
Val Confusion Matrix:
[[    0     0     0     0]
 [    0   471     0     0]
 [    0 30986     0     0]
 [    0   543     0     0]]
