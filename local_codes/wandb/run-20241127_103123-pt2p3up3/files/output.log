Some weights of EsmModel were not initialized from the model checkpoint at facebook/esm1b_t33_650M_UR50S and are newly initialized: ['esm.pooler.dense.bias', 'esm.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Trainable parameters: 0.657924 M
Total parameters: 653.014425 M
ESM1b(
  (esm): EsmModel(
    (embeddings): EsmEmbeddings(
      (word_embeddings): Embedding(33, 1280, padding_idx=1)
      (layer_norm): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.0, inplace=False)
      (position_embeddings): Embedding(1026, 1280, padding_idx=1)
    )
    (encoder): EsmEncoder(
      (layer): ModuleList(
        (0-32): 33 x EsmLayer(
          (attention): EsmAttention(
            (self): EsmSelfAttention(
              (query): Linear(in_features=1280, out_features=1280, bias=True)
              (key): Linear(in_features=1280, out_features=1280, bias=True)
              (value): Linear(in_features=1280, out_features=1280, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
            (output): EsmSelfOutput(
              (dense): Linear(in_features=1280, out_features=1280, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
            (LayerNorm): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
          )
          (intermediate): EsmIntermediate(
            (dense): Linear(in_features=1280, out_features=5120, bias=True)
          )
          (output): EsmOutput(
            (dense): Linear(in_features=5120, out_features=1280, bias=True)
            (dropout): Dropout(p=0.0, inplace=False)
          )
          (LayerNorm): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
        )
      )
      (emb_layer_norm_after): LayerNorm((1280,), eps=1e-05, elementwise_affine=True)
    )
    (pooler): EsmPooler(
      (dense): Linear(in_features=1280, out_features=1280, bias=True)
      (activation): Tanh()
    )
    (contact_head): EsmContactPredictionHead(
      (regression): Linear(in_features=660, out_features=1, bias=True)
      (activation): Sigmoid()
    )
  )
  (layer1): Linear(in_features=1280, out_features=512, bias=True)
  (relu): ReLU()
  (layer2): Linear(in_features=512, out_features=4, bias=True)
)
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.79it/s]
0.925
0.6206349206349207
0.925
[[140  20   0]
 [  0 156   0]
 [  0   4   0]]
Average Loss: 0.2143
Accuracy: 0.0000, 0.9250

Sample of results:
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
[1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
[1.1920922133867862e-06, 0.0, 0.053362056612968445, 2.0265558760002023e-06, 0.5757172107696533, 1.018017053604126, 1.1920922133867862e-06, 1.0900863409042358, 0.06629231572151184, 1.6331539882230572e-05, 0.15375769138336182, 0.0011116046225652099, 0.19730612635612488, 0.9186841249465942, 0.008591356687247753, 0.002593608107417822, 0.0019377757562324405, 0.0037231191527098417, 0.004390006884932518, 0.006456468254327774, 1.088151454925537, 0.0, 0.38522130250930786, 4.004055023193359, 2.1219027985353023e-05, 4.172316494077677e-06, 2.50339189733495e-06, 4.970904046786018e-05, 0.0020067808218300343, 0.00272486568428576, 0.04088009148836136, 2.8610190838662675e-06, 1.1920928955078125e-07, 2.622600959512056e-06, 0.0, 0.09167030453681946, 0.839382529258728, 0.03269796073436737, 5.960462772236497e-07, 2.264974000354414e-06, 1.7881233361549675e-05, 0.00012218205665703863, 6.6756983869709074e-06, 3.337854423079989e-06, 5.054346183896996e-05, 1.549719627291779e-06, 1.7881378653328284e-06, 6.639737694058567e-05, 0.000476246903417632, 0.5649295449256897, 0.036486245691776276, 2.3841855067985307e-07, 0.0016033902065828443, 1.1920928955078125e-07, 0.12668904662132263, 0.8299865126609802, 0.22227734327316284, 5.960462772236497e-07, 0.0006332775810733438, 8.511181658832356e-05, 0.09442364424467087, 1.1920928955078125e-07, 0.06262152642011642, 0.054259445518255234, 6.794906312279636e-06, 5.722029982280219e-06, 4.887569048150908e-06, 0.4244108200073242, 2.3841855067985307e-07, 7.033323981886497e-06, 0.014915494248270988, 2.0265558760002023e-06, 2.688549041748047, 0.0, 0.0, 0.054598577320575714, 3.2888681888580322, 0.005440192297101021, 0.0007631250191479921, 3.579535484313965, 3.433168603805825e-05, 0.5695168375968933, 5.960462772236497e-07, 0.0, 0.714211642742157, 0.059930332005023956, 0.02817070297896862, 1.1920928955078125e-07, 0.33017152547836304, 0.4240182638168335, 0.9556615352630615, 1.538628339767456, 0.4277297258377075, 3.7312893867492676, 0.00012110931129427627, 9.775113539944869e-06, 0.0, 0.035286836326122284, 2.3841855067985307e-07, 0.5254133939743042, 0.030887596309185028, 1.1920928955078125e-07, 4.768370729379967e-07, 0.0, 0.0011794761521741748, 5.722029982280219e-06, 3.0397906812140718e-05, 0.01729384809732437, 0.0006189814303070307, 1.1920928955078125e-07, 1.1920928955078125e-07, 0.1409505009651184, 7.152555667744309e-07, 0.17278863489627838, 0.018906384706497192, 0.008063619956374168, 8.34461570775602e-06, 1.1027346849441528, 0.4980541169643402, 0.0013804440386593342, 1.8256624937057495, 7.152555667744309e-07, 0.00013565097469836473, 0.08368401974439621, 0.0, 0.12934964895248413, 0.0026964517310261726, 2.27052903175354, 0.08349268138408661, 3.397406908334233e-05, 3.576278118089249e-07, 0.28174009919166565, 0.9406687021255493, 0.2212185263633728, 0.0781189501285553, 2.3841855067985307e-07, 0.001515907933935523, 0.3796156048774719, 2.717935058171861e-05, 1.1563234693312552e-05, 0.12857896089553833, 3.099436753473128e-06, 6.318072792055318e-06, 0.46826040744781494, 1.9099946022033691, 0.04051967337727547, 6.6756983869709074e-06, 0.0, 0.0021125399507582188, 0.00017844040121417493, 0.815446138381958, 0.24517564475536346, 2.3841855067985307e-07, 0.3990238606929779, 0.0005931287305429578, 2.7418100216891617e-06, 0.2329590767621994, 0.0, 1.1920928955078125e-07, 0.6998239755630493, 0.056291740387678146, 0.040455907583236694, 0.0005122303264215589, 6.204125881195068, 0.0027387752197682858, 0.02113359421491623, 0.000753357307985425, 0.0002668739762157202, 0.28336668014526367, 0.6710456609725952, 9.65590606938349e-06, 0.01179706770926714, 0.0018917298875749111, 0.002415241440758109, 0.00019941726350225508, 0.0003369478799868375, 0.005421103443950415, 0.002339961240068078, 0.0036826191935688257, 4.042906284332275, 0.00030071981018409133, 0.0030743263196200132, 0.0003777029342018068, 0.004693918861448765, 0.006567797623574734, 0.004710529465228319, 0.3565079867839813, 0.0009912106906995177, 3.349725011503324e-05, 1.0490362001291942e-05, 6.186770770000294e-05, 8.83301836438477e-05, 0.0024700628127902746, 0.0005865760613232851, 0.007903612
[[140  20   0]
 [  0 156   0]
 [  0   4   0]]
  0%|          | 24/100000 [00:12<14:43:09,  1.89it/s]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.53it/s]
0.965625
0.6447689041319614
0.965625
[[152   8   0]
 [  2 157   0]
 [  0   1   0]]
Average Loss: 0.0946
Accuracy: 0.0000, 0.9656

Sample of results:
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
[1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
[0.0011060080723837018, 3.6954811548639555e-06, 0.3218388259410858, 0.8627408742904663, 8.344647426383744e-07, 0.0004409771354403347, 7.30726242181845e-05, 0.002593608107417822, 2.3841855067985307e-07, 1.1920928955078125e-07, 0.18214167654514313, 6.6756983869709074e-06, 0.0, 0.13012133538722992, 4.768370729379967e-07, 2.3841855067985307e-07, 5.245195097813848e-06, 2.2411095415009186e-05, 0.15044499933719635, 1.7881233361549675e-05, 0.002593608107417822, 1.1920928955078125e-07, 0.0, 1.1920922133867862e-06, 0.0455436073243618, 2.3841855067985307e-07, 0.0, 0.0007658647955395281, 0.0, 0.008869417943060398, 0.00013374387344811112, 0.7047754526138306, 0.0, 0.18452592194080353, 1.1920928955078125e-07, 2.3841855067985307e-07, 0.11543072760105133, 5.0067778829543386e-06, 0.014428333379328251, 5.960462772236497e-07, 0.0, 0.0004625442670658231, 1.811964830267243e-05, 0.0006189814303070307, 2.3841855067985307e-07, 0.0037231191527098417, 0.007716253399848938, 1.1920928955078125e-07, 3.302042750874534e-05, 1.1920928955078125e-07, 0.012762300670146942, 0.2863621115684509, 1.1920928955078125e-07, 0.00328762736171484, 0.45193684101104736, 0.0006189814303070307, 1.1920928955078125e-07, 3.2871029376983643, 0.08418077975511551, 1.1920928955078125e-07, 0.0018180761253461242, 0.0008647278882563114, 1.4305104514278355e-06, 1.1920928955078125e-07, 1.914119839668274, 0.0037308388855308294, 0.00042048198520205915, 0.6293978095054626, 0.19373123347759247, 0.5117635726928711, 3.5762725474342005e-06, 2.3841830625315197e-06, 3.576278118089249e-07, 0.039789967238903046, 2.3841855067985307e-07, 0.0031424211338162422, 0.009739027358591557, 1.1920928955078125e-07, 5.960462772236497e-07, 2.8610190838662675e-06, 0.22914054989814758, 3.5762725474342005e-06, 1.4305104514278355e-06, 0.10810969769954681, 0.1372387558221817, 9.53673918502318e-07, 7.152555667744309e-07, 2.145764938177308e-06, 0.007358471862971783, 0.0, 1.0013530300057027e-05, 3.576278118089249e-07, 1.7881378653328284e-06, 0.021942228078842163, 1.1920928955078125e-07, 3.6954811548639555e-06, 0.0021282420493662357, 0.11048779636621475, 0.0, 0.00047291064402088523, 0.0003748429589904845, 1.1920928955078125e-07, 6.449015199905261e-05, 0.06821514666080475, 0.0011239885352551937, 0.0006607971154153347, 0.0, 0.048193782567977905, 0.005834572482854128, 2.3841855067985307e-07, 0.30538925528526306, 1.271902084350586, 2.3841855067985307e-07, 1.1920928955078125e-07, 0.4074300229549408, 1.1920922133867862e-06, 2.264974000354414e-06, 0.0, 5.722029982280219e-06, 7.152555667744309e-07, 8.344647426383744e-07, 1.30336332321167, 4.768360213347478e-06, 1.1920928955078125e-07, 0.2378128170967102, 1.1920928955078125e-07, 0.26079124212265015, 0.0, 0.001090646954253316, 1.5889122486114502, 0.004784919787198305, 2.9802276912960224e-06, 3.218645815650234e-06, 2.3841855067985307e-07, 2.1765360832214355, 2.3841855067985307e-07, 0.2588005065917969, 1.1920928955078125e-07, 2.0265558760002023e-06, 0.0, 0.0015575671568512917, 0.0018889933126047254, 1.1920928955078125e-07, 0.0, 0.0, 2.3841855067985307e-07, 0.07104207575321198, 0.0018110554665327072, 0.0013190149329602718, 6.198863957251888e-06, 3.5762725474342005e-06, 8.22540732769994e-06, 1.1920922133867862e-06, 0.002593608107417822, 1.1920928955078125e-07, 0.516839861869812, 0.004461691714823246, 0.17442835867404938, 0.0010338444262742996, 0.0, 0.12272872775793076, 0.0005054388893768191, 0.005572499707341194, 0.0035171571653336287, 0.0025250001344829798, 0.006149892695248127, 0.018499573692679405, 4.768370729379967e-07, 0.00972238089889288, 0.0, 0.0020329540129750967, 1.1183476448059082, 8.344647426383744e-07, 0.00374509091489017, 0.004461216740310192, 0.026281172409653664, 0.0078002386726439, 0.0007438277243636549, 2.3841855067985307e-07, 0.0, 0.010659541934728622, 0.003619787283241749, 0.05874445289373398, 0.003668603952974081, 6.282132380874828e-05, 0.1128951758146286, 0.0005931287305429578, 0.015653124079108238, 0.00815360527485609, 0.0024012085050344467, 0.007523654028773308, 0.01210026815533638, 0.00481991795822978, 0.009531821124255657, 0.0013007998932152987, 0.0135433
[[152   8   0]
 [  2 157   0]
 [  0   1   0]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.59it/s]
0.959375
0.6405379970198416
0.959375
[[149  11   0]
 [  1 158   0]
 [  1   0   0]]
Average Loss: 0.0989
Accuracy: 0.0000, 0.9594

Sample of results:
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
[1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
[0.0, 0.2218114286661148, 0.0011239885352551937, 1.1920928955078125e-07, 0.1700505018234253, 0.22944024205207825, 0.503134548664093, 1.25566565990448, 1.678871989250183, 0.0, 0.03544677793979645, 1.9073469275099342e-06, 0.045213352888822556, 3.576278118089249e-07, 1.4305104514278355e-06, 0.014924301765859127, 4.196079316898249e-05, 0.004644795786589384, 0.0009814451914280653, 0.0028879623860120773, 0.11465316265821457, 0.0, 8.344647426383744e-07, 0.2766791880130768, 1.811964830267243e-05, 0.20101141929626465, 0.016108017414808273, 2.3841855067985307e-07, 2.9205850296420977e-05, 0.0, 2.622600959512056e-06, 2.3841830625315197e-06, 0.6870011687278748, 0.0, 0.020321734249591827, 0.0, 0.00019894052820745856, 0.0, 0.090516597032547, 0.00011562633153516799, 0.0, 0.018394246697425842, 8.344647426383744e-07, 0.004830595105886459, 0.0036314274184405804, 5.125986263010418e-06, 0.06037820503115654, 3.4689302992774174e-05, 1.6212332411669195e-05, 0.8050934076309204, 0.003346678102388978, 3.349725011503324e-05, 3.814689989667386e-06, 0.00757263507694006, 1.1920928955078125e-07, 4.529942998487968e-06, 0.0, 0.0007583603728562593, 0.05735817551612854, 0.003997550345957279, 0.20431825518608093, 0.05523284524679184, 0.11115650832653046, 0.16555136442184448, 0.00646085012704134, 0.055469367653131485, 0.14888571202754974, 2.3841855067985307e-07, 0.29246392846107483, 0.27273058891296387, 0.1680016666650772, 0.0, 0.0249206330627203, 0.0, 0.0, 0.17241868376731873, 3.735470771789551, 1.3113013892507297e-06, 2.0265558760002023e-06, 0.0, 1.0728830375228426e-06, 0.014273690059781075, 2.3841830625315197e-06, 0.0011177966371178627, 2.3841855067985307e-07, 1.8131678104400635, 0.0, 0.006216356996446848, 1.7046782886609435e-05, 1.0588427782058716, 0.012024770490825176, 1.0207111835479736, 1.168244216387393e-05, 0.005440192297101021, 0.09064442664384842, 7.152555667744309e-07, 0.0006189814303070307, 0.0001404186914442107, 0.018069300800561905, 8.22540732769994e-06, 0.0015491163358092308, 2.3841855067985307e-07, 0.0, 0.261655330657959, 2.0861407392658293e-05, 0.7251997590065002, 0.2091723531484604, 6.6756983869709074e-06, 5.1973900554003194e-05, 5.960446742392378e-06, 0.0, 0.018712535500526428, 0.0038722786121070385, 0.0021799865644425154, 9.298281838709954e-06, 2.3841855067985307e-07, 0.04082241654396057, 1.1041983366012573, 9.53673918502318e-07, 0.0, 1.1920928955078125e-07, 0.2008320838212967, 3.814689989667386e-06, 4.768370729379967e-07, 0.13094542920589447, 0.25263285636901855, 0.00422074506059289, 0.0, 0.0, 3.576278118089249e-07, 0.0020680485758930445, 0.0015047190245240927, 0.0018542492762207985, 0.10769756883382797, 0.23583118617534637, 0.0, 0.0038925844710320234, 1.7899177074432373, 0.0, 0.0181602630764246, 0.014538896270096302, 0.09164538979530334, 0.04170642048120499, 9.298281838709954e-06, 0.07959533482789993, 0.00757263507694006, 0.0, 0.001111485529690981, 0.60568767786026, 3.576278118089249e-07, 4.160317621426657e-05, 0.23943929374217987, 0.1884835809469223, 2.622600959512056e-06, 1.4753777980804443, 2.3722368496237323e-05, 3.576278118089249e-07, 0.0007059466443024576, 0.43114107847213745, 0.0, 1.259626865386963, 0.0007140471134334803, 0.006712744012475014, 1.0728830375228426e-06, 0.012351687066257, 0.0024373605847358704, 0.019010020419955254, 7.033323981886497e-06, 1.0490362001291942e-05, 0.019036687910556793, 0.0, 5.960462772236497e-07, 0.01069634035229683, 5.888765736017376e-05, 0.0002989322238136083, 0.00595770264044404, 0.002458171220496297, 0.0006399491103366017, 0.0024536524433642626, 0.02435467764735222, 0.05865486338734627, 0.0006125480867922306, 0.003994225990027189, 3.45700973412022e-05, 0.011794358491897583, 0.0009662012453190982, 0.005325654521584511, 0.002032359130680561, 0.00641288049519062, 0.00014244495832826942, 0.002286202972754836, 0.08492579311132431, 0.003008247120305896, 0.009449399076402187, 0.00023612573568243533, 0.07941576093435287, 0.0044339201413095, 3.9090042114257812, 0.0600440576672554, 0.0024571011308580637, 2.3841574147809297e-05, 0.0001501924270996824, 0.030584027990698814, 0.008439235389232635, 0.0014807938
[[149  11   0]
 [  1 158   0]
 [  1   0   0]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.60it/s]
Average Loss: 0.1207
Accuracy: 0.0000, 0.9469
0.9467580132126254
0.946875
[[144  16]
 [  1 159]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 22.21it/s]
Average Loss: 0.1618
Accuracy: 0.9437
F1 (macro): 0.9437
F1 (micro): 0.9437
[[145  15]
 [  3 157]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 22.19it/s]
Average Loss: 0.1301
Accuracy: 0.9563
F1 (macro): 0.6385
F1 (micro): 0.9563
[[149  11   0]
 [  2 157   0]
 [  0   1   0]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.53it/s]
                                              sequence  label  pred      loss  \
261  MRSLFCCPLCGKPLRQQGNALCCLNRHSFDFAAQGYVNLLPANRRH...      3     2  6.443192
31   MFLTRGFRKWTMTMIMVLALTSCRIFVTSVISVTDLWDPEIRTIPV...      1     2  2.458361
62   MKVKLIAATEVDESAIAEIGFQDLYEVEKIDGDPPFGDWDADFLAE...      1     2  2.076576
47   MQVHKGAYRLPRMSALKDRIKLARKHADLTQRQLAEAVGVSQPVIS...      1     2  1.796357
54   MNVPGNDELISLPKATFLSMLQSSLDGMKQTAARFAPNLSMSGFPG...      1     2  1.753063

     is_incorrect
261          True
31           True
62           True
47           True
54           True
Average Loss: 0.1401
Accuracy: 0.9344
F1 (macro): 0.6238
F1 (micro): 0.9344
[[142  18   0]
 [  2 157   0]
 [  0   1   0]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.39it/s]
                                              sequence                 label  \
223  MGVLRLSHVDVQVTDLDLATAYYTEVIGMLEVERDDTSVYLKCWDE...  unclassified entries
248  MAEQPDTPKILNEISKSNSARTKTPASRKQQVARRRFIIVVMFFLP...  unclassified entries
259  MANVVVVGTQWGDEGKGKIVDLLTGYADYVVRFQGGNNAGHTLVVD...  unclassified entries
151  MEAIGPNKHGNPFIGHEHTLYDISPGHVYAKSKRMVEQLVMKANNS...               Viruses
229  MPMPKDTLFFGFAPKLTGEQRVYVDSIFDRQITFVNARSGTGKTTL...    cellular organisms

                   pred      loss  is_incorrect
223  cellular organisms  5.623214          True
248  cellular organisms  4.944829          True
259  cellular organisms  4.474035          True
151  cellular organisms  4.424879          True
229             Viruses  3.743510          True
Average Loss: 0.1864
Accuracy: 0.9375
F1 (macro): 0.6280
F1 (micro): 0.9375
[[149  11   0]
 [  6 151   0]
 [  0   3   0]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 21.54it/s]
                                              sequence    label  \
44   MKIKGYEKAIILHLGALYDAANEGNEKVKPLHRLILNLPNVDEEAV...  Viruses
43   MWLILIIIVVVIGAIFLARKASIPVENKTQEFLKTQQNRGKEEVSG...  Viruses
118  MEDDTNIVPHPLDSSCTLDALIIDALREGEGQEAIIEELIRQPMAR...  Viruses
72   MKLSDIYLELKKGYADSLLYSDLSLLVNIMEYEKDIDVMSIQSLVA...  Viruses
79   MSIRLGYACINTELREQGIFSSRGMVLKTLTDTSRGGVELARKLAI...  Viruses

                   pred    loss  is_incorrect
44   cellular organisms  3.2760          True
43   cellular organisms  2.0000          True
118  cellular organisms  1.6887          True
72   cellular organisms  1.5887          True
79   cellular organisms  1.5048          True
Average Loss: 0.0945
Accuracy: 0.9656
F1 (macro): 0.9656
F1 (micro): 0.9656
[[150  10]
 [  1 159]]
Successfully loaded checkpoint from epoch 99999
Metrics at checkpoint: {'train_loss': 0.08703388193866704, 'train_accuracy': 0.972, 'train_f1_micro': 0.972, 'train_f1_macro': 0.6321182114729275, 'train_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,  1811,   184,     0],
       [    0,   157, 13741,     1],
       [    0,     8,    98,     0]]), 'val_loss': 0.06967763296049088, 'val_accuracy': 0.9805, 'val_f1_micro': 0.9805, 'val_f1_macro': 0.5561100310384487, 'val_confusion_matrix': array([[    0,     0,     0,     0],
       [    0,   220,    18,     0],
       [    0,   180, 15468,     0],
       [    0,    11,   103,     0]]), 'epoch': 100000, 'current_portion': 0.0625, 'lr': 0.0008965153869722053}
320it [00:14, 22.23it/s]
Average Loss: 0.1461
Accuracy: 0.9469
F1 (macro): 0.6322
F1 (micro): 0.9469
[[146  14   0]
 [  2 157   0]
 [  0   1   0]]
